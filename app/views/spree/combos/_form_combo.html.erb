<%= form_tag populate_combos_orders_path, id: "form-combo" do %>

    <% @combos.each do |c| %>
      <%#=<h2> <%= c.name %>
      <%#= hidden_field_tag "combos[#{c.id}][combo_id]", c.id %>
    
      <% c.combo_lines.each do |cl| %>
        <% if cl.taxon != nil %>
          <% id = rand(10000) + cl.id %>
          <h3> <%= pluralize(cl.quantity,"unidad","unidades") %> de la categoría <b><%= cl.taxon.name %></b>  </h3>
          <div id="accordion-<%= id %>">
            <a class="list-group-item" data-toggle="collapse" data-parent="accordion-<%= id %>" href="#<%= id %>" style="padding:0 ; border:0;">
              <p class="combo-instruction"> Seleccione productos y cantidades para la categoría (Deben sumar <b><%= cl.quantity %></b>)     
                <span class="status_label" >
                </span>
              </p>
            </a>
            <div id="<%= id %>" class="list-group panel-collapse accordion-body collapse accordion-category">
            <p style="font-size: 1em;"> Disponible: 
            <span class="available_quantity_label" id="available_quantity_<%= id %>" >
              <%= cl.quantity %>
            </span>

            
            </p>
              <% cl.taxon.all_children.each do |p| %> 
                <%= render partial: "product_combo", locals: {p: p, cl: cl, type: 0} %>
              <% end %>
            </div>
          </div>
        <% elsif cl.taxon == nil && cl.product != nil %>
          <% if cl.product.can_supply? %>
            <h3> <%= pluralize(cl.quantity,"unidad","unidades") %> del producto <b><%= cl.product.name %></b>  </h3>
            <%= render partial: "producto_unico_combo", locals: {p: cl.product, cl: cl, type: 1} %>
          <% else %>
            <h3 style="color: red">  <b><%= cl.product.name %></b> sin stock </h3>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
   <br>
   <br>
   <%= submit_tag "Continuar" , class: "btn btn-success" %>
<% end %>  
