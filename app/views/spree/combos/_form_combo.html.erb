<%= form_tag populate_combos_orders_path, id: "form-combo" do %>
  <% @combos.each do |combo| %>
    <% combo_random_id = rand(1000000000000) %>
    <%= hidden_field_tag "combos[#{combo_random_id}][combo_id]", combo.id %>
    <% combo.combo_lines.each do |combo_line| %>
      <% if combo_line.taxon.present? %>
        <%= render partial: 'taxon', locals: {combo_line: combo_line, combo_random_id: combo_random_id} %>

      <% elsif combo_line.product.present? && combo_line.product.can_supply? %>
        <% if combo_line.product.has_variants? %>
          <h3> <%= pluralize(combo_line.quantity,"unidad","unidades") %> del producto <b><%= combo_line.product.name %></b></h3>
          <%= render partial: "producto_con_variantes", locals: {product: combo_line.product, combo_line: combo_line, combo_random_id: combo_random_id} %>

        <% else %>
          <h3> <%= pluralize(combo_line.quantity,"unidad","unidades") %> del producto <b><%= combo_line.product.name %></b></h3>
          <%= render partial: "producto_sin_variantes", locals: {product: combo_line.product, combo_line: combo_line, combo_random_id: combo_random_id} %>

        <% end %>
      <% else %>
        <h3 style="color: red"><b><%= combo_line.product.name %></b> sin stock </h3>
      <% end %>
    <% end %>
  <% end %>
 <br>
 <br>
 <%= submit_tag "Continuar" , class: "btn btn-success" %>
<% end %>  
